@model Toolify.ProductService.Models.Product

@{
    ViewData["Title"] = Model.Name;

    bool hasDiscount = Model.Discount > 0;
    bool isOutOfStock = Model.StockQuantity <= 0;
    decimal finalPrice = Model.Price;
    if (hasDiscount)
    {
        finalPrice = Model.Price - (Model.Price * Model.Discount / 100);
    }
}

<div class="product-details-container">

    <div class="detail-image">
        <img src="https://localhost:7188@(Model.ImagePath)"
             alt="@Model.Name"
             onerror="this.onerror=null; this.src='/images/no-image.png';" />
    </div>

    <div class="detail-info">
        <h1 class="detail-title">@Model.Name</h1>

        <div class="detail-rating-row">
            <span class="stars">★</span>
            <span class="rating-value">0.0</span>
            <span class="reviews-count">0 отзывов</span>
            <span style="margin-left: 20px; color: #666; font-size: 0.9em;">
                Артикул: @Model.ArticleNumber
            </span>
        </div>

        <div class="action-buttons-row">
            <button class="btn-text-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
                В избранное
            </button>

            <button class="btn-text-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                Сравнить
            </button>
        </div>

        <div class="detail-description">
            <h3>Описание</h3>
            <p>@Model.FullDescription</p>
        </div>
    </div>

   

    <div class="detail-buy-block product-card">
        <div class="price-wrap">
            <span class="main-price">@finalPrice.ToString("N2") Руб</span>
            @if (hasDiscount)
            {
                <span class="old-price">@Model.Price.ToString("N2") Руб</span>
                <span class="badge discount">-@Model.Discount%</span>
            }
        </div>

        @if (isOutOfStock)
        {
            <div class="stock out">Нет в наличии</div>
            <button class="btn-add-cart disabled" disabled>Нет в наличии</button>
        }
        else
        {
            <div class="stock in">В наличии</div>
            <button type="button"
                    class="btn-add-cart"
                    onclick="addToCartAnimated(event, @Model.Id, this)">
                Добавить в корзину
            </button>
        }
    </div>
</div>

<div class="reviews-container">

    <div class="reviews-left-column">
        <h2 class="reviews-title">Отзывы о товаре</h2>

        <div class="reviews-filters">
            <span class="filter-sort">Сортировать по: <a href="#" class="active">Дате</a> <a href="#">Рейтингу</a></span>
            <div class="filter-tags">
                <span>5 звезд</span>
                <span>4 звезды</span>
                <span>3 звезды</span>
                <span>2 звезды</span>
                <span>1 звезда</span>
            </div>
        </div>

        <div class="review-list">
            <div class="review-item">
                <div class="review-header">
                    <div class="user-avatar"></div>
                    <span class="user-name">Аноним</span>
                    <div class="stars-green">★★★★★</div>
                </div>
                <div class="review-body">
                    <span class="comment-label">Комментарий</span>
                    <p>все ок</p>
                </div>
                <div class="shop-response">
                    <span class="shop-name">Интернет-магазин <i class="check-icon">✔</i></span>
                    <p>Добрый день, спасибо за высокую оценку.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="reviews-right-column">
        <div class="rating-card">
            <h3 class="rating-title">Отзывы покупателей (44)</h3>

            <div class="rating-main-row">
                <div class="stars-green big">★★★★★</div>
                <div class="rating-score">4.7 <span>/ 5</span></div>
            </div>

            <div class="rating-bars">
                <div class="bar-row">
                    <span class="star-label">5 звезд</span>
                    <div class="progress-track"><div class="progress-fill" style="width: 90.9%;"></div></div>
                    <span class="percent-label">90.9%</span>
                </div>
                <div class="bar-row">
                    <span class="star-label">4 звезды</span>
                    <div class="progress-track"><div class="progress-fill" style="width: 0%;"></div></div>
                    <span class="percent-label">1%</span>
                </div>
                <div class="bar-row">
                    <span class="star-label">3 звезды</span>
                    <div class="progress-track"><div class="progress-fill" style="width: 2.3%;"></div></div>
                    <span class="percent-label">2.3%</span>
                </div>
                <div class="bar-row">
                    <span class="star-label">2 звезды</span>
                    <div class="progress-track"><div class="progress-fill" style="width: 4.5%;"></div></div>
                    <span class="percent-label">4.5%</span>
                </div>
                <div class="bar-row">
                    <span class="star-label">1 звезда</span>
                    <div class="progress-track"><div class="progress-fill" style="width: 2.3%;"></div></div>
                    <span class="percent-label">2.3%</span>
                </div>
            </div>

            <button class="btn-leave-review">
                Оставить свой отзыв
            </button>
        </div>
    </div>

</div>